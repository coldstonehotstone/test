import yfinance as yf
tickerSymbol = 'XONE'
tickerData = yf.Ticker(tickerSymbol)
tickerDf = tickerData.history(period='1d', start='1950-1-1', end='2021-6-10')

print(tickerDf)


for N in range(12, 12 * 100, 12):
  pos_cnt = 0
  cnt = 0
  ar_avg = 0
  gain_avg = 0
  for k in range(0, len(tickerDf) - 20 * N, 20):
    shares = 0
    for i in range(N):
        shares = shares + 1000.0 / tickerDf.iloc[k+i*20]['Close']
    
    gain = shares *  tickerDf.iloc[k + 20* N]['Close'] / 1000.0 / N
    
    # 30 + 60 + 90 .. = 30(1+2+3...+12) = 30 * (12+1) * 12 / 2 = 30 * 6 * 13 = 2340
    ar = gain ** (365.0 / 30 / (1+N) / N * 2)
    #print("one year ", tickerDf.iloc[k].name, ar)
    if ar > 1:
        pos_cnt = pos_cnt+1
    cnt = cnt + 1
    ar_avg = ar_avg + ar
    gain_avg = gain_avg + gain
  print(N/12, "year, gain possibility " , 1.0 * pos_cnt / cnt, ar / cnt, gain_avg/cnt)


# this means if we buy spy once per month, it only gurantees 100% when the range is 17 years
# the gain is limited for SPY

# 1980-12-12    0.100751    0.101189    0.100751    0.100751  469033600        0.0           0.0
#2021-06-09  127.209999  127.750000  126.519997  127.129997   56877900        0.0           0.0

#1.0 year, gain possibility  0.7890173410404624 0.0029660292235010395 1.0582197458489409
#2.0 year, gain possibility  0.8353293413173652 0.0030271572914639566 1.116282333360034
#3.0 year, gain possibility  0.8385093167701864 0.0031248310413416174 1.175804093027888
#4.0 year, gain possibility  0.8193548387096774 0.003238900109553325 1.2338176470105398
#5.0 year, gain possibility  0.8389261744966443 0.0033659601847370515 1.2863618728026627
#6.0 year, gain possibility  0.8496503496503497 0.0035051293191480835 1.3292010395695926
#7.0 year, gain possibility  0.8832116788321168 0.003656868300264708 1.3603886249052723
#8.0 year, gain possibility  0.9274809160305344 0.0038231422380141425 1.3852172558443292
#9.0 year, gain possibility  0.948 0.004005860150391664 1.4228402374110254
#10.0 year, gain possibility  0.9453781512605042 0.004207241298260323 1.4801288015905074
#11.0 year, gain possibility  0.9424778761061947 0.0044300670847095495 1.5569539421042007
#12.0 year, gain possibility  0.9392523364485982 0.004678008183606027 1.6252469378945036
#13.0 year, gain possibility  0.9405940594059405 0.004955566705125334 1.6912816349599022
#14.0 year, gain possibility  0.9526315789473684 0.005268013678286822 1.7487684999375837
#15.0 year, gain possibility  0.9719101123595506 0.00562257269359787 1.8018424152438925
#16.0 year, gain possibility  0.9939759036144579 0.006028533032651395 1.853504208155403
#17.0 year, gain possibility  1.0 0.006497862722603514 1.9522130849812818
#18.0 year, gain possibility  1.0 0.007046593341559567 2.075298748339972
#19.0 year, gain possibility  1.0 0.007696703925166854 2.2001895199354533
#20.0 year, gain possibility  1.0 0.008479115982765193 2.333713488002346
#21.0 year, gain possibility  1.0 0.009438631390789268 2.4775889278614738
#22.0 year, gain possibility  1.0 0.010643138425436802 2.6186870639846225
#23.0 year, gain possibility  1.0 0.01220023726895093 2.7562152845350485
#24.0 year, gain possibility  1.0 0.014291293747975194 2.918071031293195
#25.0 year, gain possibility  1.0 0.017247712504550733 3.157204120546459
#26.0 year, gain possibility  1.0 0.02174675594279942 3.41074695166228
#27.0 year, gain possibility  1.0 0.02942172347945098 3.6619343671108138
#28.0 year, gain possibility  1.0 0.04546958810836383 4.044487512751868
#29.0 year, gain possibility  1.0 0.10003233382096459 4.6837125364883025


# QQQ
# 1999-03-10   44.441193   44.468357   43.707750   44.386864   5232000        0.0           0.0
# 2021-06-09  338.170013  338.970001  336.649994  336.839996  21485300        0.0           0.0

#1.0 year, gain possibility  0.75 0.003792820446745708 1.0599654432375327
#2.0 year, gain possibility  0.81640625 0.003954726869698073 1.1068229083561845
#3.0 year, gain possibility  0.8565573770491803 0.0041301739095483715 1.1833299546508202
#4.0 year, gain possibility  0.875 0.004333167840142583 1.2734528212390417
#5.0 year, gain possibility  0.8954545454545455 0.004564201480605416 1.3694740237942875
#6.0 year, gain possibility  0.9182692307692307 0.004823845381408317 1.467495019102826
#7.0 year, gain possibility  0.9489795918367347 0.005115955984344748 1.5737174192147232
#8.0 year, gain possibility  0.9510869565217391 0.005447403277120699 1.693828218495783
#9.0 year, gain possibility  0.9476744186046512 0.0058259485194708145 1.8260970036553554
#10.0 year, gain possibility  0.9375 0.006261524444344223 1.9759377441746726
#11.0 year, gain possibility  1.0 0.006767942116732247 2.17471569008726
#12.0 year, gain possibility  1.0 0.007364067009445061 2.3777739855215323
#13.0 year, gain possibility  1.0 0.008075980884891944 2.585524420917969
#14.0 year, gain possibility  1.0 0.008940070871191747 2.796151057417819
#15.0 year, gain possibility  1.0 0.010011545314183998 3.0302570485112206
#16.0 year, gain possibility  1.0 0.01137557043659468 3.2764645728388944
#17.0 year, gain possibility  1.0 0.013170526972875796 3.527251374061756
#18.0 year, gain possibility  1.0 0.01563879332913517 3.835423378869354
#19.0 year, gain possibility  1.0 0.019246502889222042 4.2170752437532375
#20.0 year, gain possibility  1.0 0.02501919848394297 4.563366799809787
#21.0 year, gain possibility  1.0 0.03573951601192671 4.965840600210326
#22.0 year, gain possibility  1.0 0.06254005635099882 5.5626706665049515

# TAN
#                  Open        High         Low       Close   Volume  Dividends  Stock Splits
#Date
#2008-04-15  191.917407  192.882950  190.951888  192.882950     9810        0.0           0.0
#2008-04-16  200.532882  203.726544  198.676096  202.463943   121200        0.0           0.0
#2008-04-17  199.715880  201.944023  192.140207  195.185318    67020        0.0           0.0
#2008-04-18  197.562019  199.790162  194.888243  197.413467    37610        0.0           0.0
#2008-04-21  199.047477  200.532906  195.556710  199.790192    30230        0.0           0.0
#...                ...         ...         ...         ...      ...        ...           ...
#2021-06-03   76.870003   77.489998   75.349998   75.559998   974100        0.0           0.0
#2021-06-04   76.300003   77.559998   76.029999   76.839996   631600        0.0           0.0
#2021-06-07   76.779999   76.779999   74.879997   76.559998  1191100        0.0           0.0
#2021-06-08   77.339996   78.000000   75.000000   76.959999  1489700        0.0           0.0
#2021-06-09   77.949997   78.599998   76.419998   76.610001   912500        0.0           0.0
#
#[3312 rows x 7 columns]
#1.0 year, gain possibility  0.538961038961039 0.006675420924246338 1.0830474817033813
#2.0 year, gain possibility  0.528169014084507 0.007229527317420804 1.1465099609756446
#3.0 year, gain possibility  0.5153846153846153 0.007819080347593765 1.189592990785046
#4.0 year, gain possibility  0.559322033898305 0.00856089177253224 1.2242323726312745
#5.0 year, gain possibility  0.5754716981132075 0.009503354426738756 1.288669873693659
#6.0 year, gain possibility  0.6063829787234043 0.010693847324735153 1.3053397192136424
#7.0 year, gain possibility  0.5365853658536586 0.012240312199015814 1.2783650762060286
#8.0 year, gain possibility  0.4857142857142857 0.014324962017558132 1.2963486139582123
#9.0 year, gain possibility  0.4827586206896552 0.017281296646636 1.4336370675544488
#10.0 year, gain possibility  0.5434782608695652 0.021781455495701207 1.5905305612292013
#11.0 year, gain possibility  0.7058823529411765 0.02945725930309091 1.7486608774747607
#12.0 year, gain possibility  0.9090909090909091 0.04551106438034766 2.105720981461145
#13.0 year, gain possibility  1.0 0.10010160755217515 3.0097644774567778


# ARKK
#                  Open        High         Low       Close    Volume  Dividends  Stock Splits
#Date
#2014-10-31   18.734684   18.734684   18.697985   18.697985      2700        0.0             0
#2014-11-03   18.798907   18.798907   18.670462   18.697985      2300        0.0             0
#2014-11-04   18.532843   18.597066   18.532843   18.587891      7900        0.0             0
#2014-11-05   18.817261   18.817261   18.349352   18.349352     14900        0.0             0
#2014-11-06   18.431922   18.477795   18.413572   18.477795      2000        0.0             0
#...                ...         ...         ...         ...       ...        ...           ...
#2021-06-03  109.809998  110.680000  107.389999  107.430000  10095800        0.0             0
#2021-06-04  108.800003  110.294998  108.440002  109.510002   6560700        0.0             0
#2021-06-07  109.269997  113.050003  108.930000  112.690002   7392200        0.0             0
#2021-06-08  113.750000  114.769997  110.720001  113.129997   6810700        0.0             0
#2021-06-09  113.750000  114.720001  112.650002  112.849998   7349200        0.0             0
#
#[1662 rows x 7 columns]
#1.0 year, gain possibility  0.8194444444444444 0.014111062902126017 1.2133756090660994
#2.0 year, gain possibility  1.0 0.017043329434609997 1.4762199403332092
#3.0 year, gain possibility  1.0 0.021106022798435056 1.7607550246942296
#4.0 year, gain possibility  1.0 0.028020430950234612 2.059452892422167
#5.0 year, gain possibility  1.0 0.041962439414493104 2.6010606259179263
#6.0 year, gain possibility  1.0 0.08381608797360067 3.7728975841271395


# XONE
#               Open       High        Low      Close   Volume  Dividends  Stock Splits
#Date
#2013-02-07  23.660000  27.250000  23.500000  26.520000  6574300          0             0
#2013-02-08  27.400000  33.599998  27.200001  30.100000  3881400          0             0
#2013-02-11  32.270000  33.500000  29.799999  30.070000  1773300          0             0
#2013-02-12  30.070000  30.100000  27.260000  27.500000  1355800          0             0
#2013-02-13  29.110001  30.049999  27.750000  28.010000  1413900          0             0
#...               ...        ...        ...        ...      ...        ...           ...
#2021-06-03  22.879999  22.879999  21.570000  21.889999   441300          0             0
#2021-06-04  22.209999  22.500000  21.500000  22.080000   319900          0             0
#2021-06-07  22.260000  22.879999  21.700001  22.510000   247000          0             0
#2021-06-08  22.990000  23.440001  22.250000  22.709999   412500          0             0
#2021-06-09  22.959999  23.910000  21.680000  21.799999   546500          0             0
#
#[2099 rows x 7 columns]
#1.0 year, gain possibility  0.41935483870967744 0.011280218446042366 1.0429689692211968
#2.0 year, gain possibility  0.345679012345679 0.012674228020019924 1.0401960017419132
#3.0 year, gain possibility  0.30434782608695654 0.014679374313852791 1.0727541072240474
#4.0 year, gain possibility  0.2631578947368421 0.0176723416646607 1.0682973991523443
#5.0 year, gain possibility  0.28888888888888886 0.022319881025161352 1.0825189532418087
#6.0 year, gain possibility  0.30303030303030304 0.030396051915526662 1.1751116312564072
#7.0 year, gain possibility  0.47619047619047616 0.047717385235497435 1.3251620488238445
#8.0 year, gain possibility  0.8888888888888888 0.11125840910203556 1.928279846872593

